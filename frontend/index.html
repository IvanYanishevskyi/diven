<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <title>Diven</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.3.0"></script>
<link rel="stylesheet" href="styles.css">
<script>
(async () => {
  try {
    const res = await fetch("https://ipapi.co/json/");
    const data = await res.json();

    if (data.country_code !== "UA") {
      window.location.href = "/index_eng.html";
    }
  } catch (e) {
    console.warn("IP check failed:", e);
  }
})();
</script>
  <meta name="description" content="Diven –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤–∞—à—ñ —Ç–∞–±–ª–∏—Ü—ñ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ —ñ–Ω—Å–∞–π—Ç–∏. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–∞–Ω—ñ, —Å—Ç–∞–≤—Ç–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—é –º–æ–≤–æ—é, –æ—Ç—Ä–∏–º—É–π—Ç–µ –º–∏—Ç—Ç—î–≤—ñ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –∞–Ω–∞–ª—ñ–∑." />
  
</head>
<body>
  <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –¥–µ–º–æ -->
  <button class="reset-demo" onclick="localStorage.removeItem('DATAMIND_DEMO_USED'); location.reload();" title="–°–∫–∏–Ω—É—Ç–∏ –ª—ñ–º—ñ—Ç –¥–µ–º–æ">–°–∫–∏–Ω—É—Ç–∏ –¥–µ–º–æ</button>

  <!-- –•–µ–¥–µ—Ä -->
  <header class="header">
    <div class="container">
      <nav class="nav">
        <div class="logo">
          <span>Diven</span>
        </div>
        <div class="nav-links">
          <a href="#features" class="nav-link">–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ</a>
          <a href="#demo" class="nav-link">–î–µ–º–æ</a>
          <a href="#waitlist" class="nav-link">–†–∞–Ω–Ω—ñ–π –¥–æ—Å—Ç—É–ø</a>
          <a href="#en" class="nav-link lang-switch" data-lang="en">EN</a>
        </div>
      </nav>
    </div>
  </header>

  <!-- –ì–µ—Ä–æ–π-—Å–µ–∫—Ü—ñ—è -->
  <section class="hero">
    <div class="container">
      <div class="hero-badge">
        <div class="dot"></div>
        –î–æ—Å—Ç—É–ø–Ω–∞ —Ä–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—è
      </div>
      
      <h1>–ó–∞–ø–∏—Ç—É–π—Ç–µ —Å–≤–æ—ó –¥–∞–Ω—ñ –ø—Ä–æ —â–æ –∑–∞–≤–≥–æ–¥–Ω–æ.</h1>
      
      <p class="subtitle">
        –ü–µ—Ä–µ—Ç–≤–æ—Ä—é–π—Ç–µ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ –Ω–∞ —ñ–Ω—Å–∞–π—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –®–Ü. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–∞–Ω—ñ, –ø–æ—Å—Ç–∞–≤—Ç–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—é –º–æ–≤–æ—é ‚Äî —ñ –º–∏—Ç—Ç—î–≤–æ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –∞–Ω–∞–ª—ñ–∑.
      </p>
      
      <div class="hero-cta">
        <a href="#waitlist" class="btn btn-primary">
          –û—Ç—Ä–∏–º–∞—Ç–∏ —Ä–∞–Ω–Ω—ñ–π –¥–æ—Å—Ç—É–ø
          <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8.22 2.97a.75.75 0 0 1 1.06 0L14 7.69a.75.75 0 0 1 0 1.06L9.28 13.47a.75.75 0 0 1-1.06-1.06L11.94 8.5H2.75a.75.75 0 0 1 0-1.5h9.19L8.22 4.03a.75.75 0 0 1 0-1.06Z"/>
          </svg>
        </a>
        <a href="#demo" class="btn btn-secondary">
          –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –¥–µ–º–æ
        </a>
      </div>
    </div>
  </section>

  <!-- –î–µ–º–æ-—Å–µ–∫—Ü—ñ—è -->
  <section id="demo" class="demo-section">
    <div class="container">
      <div class="demo-card">
        <div class="demo-header">
          <div class="demo-title">
            –î–µ–º–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
            <div class="status-badge">1 –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –∞–Ω–∞–ª—ñ–∑</div>
          </div>
        </div>
        
        <p style="color: var(--muted); margin-bottom: 24px;">
          –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª CSV –∞–±–æ XLSX —ñ –ø–æ—Å—Ç–∞–≤—Ç–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –≤–∞—à—ñ –¥–∞–Ω—ñ. –û—Ç—Ä–∏–º–∞–π—Ç–µ –º–∏—Ç—Ç—î–≤—ñ —ñ–Ω—Å–∞–π—Ç–∏ —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó.
        </p>
        
        <form class="demo-form" id="demoForm">
<div class="form-group" style="position: relative;">
  <input type="file" accept=".csv,.xlsx,.xls" id="dataFile" class="visually-hidden-input" required>

  <label for="dataFile" class="file-drop" id="fileDrop">
    <div class="file-label">
      <div class="file-title" id="fileLabel">–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª</div>
    </div>
    <button type="button" class="file-trigger" id="fileBrowseBtn">–û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª</button>
  </label>
</div>
          <div  styles="height:250">
            <input type="text" placeholder="–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ü–æ–∫–∞–∑–∞—Ç–∏ —Ç–æ–ø-5 –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ –∑–∞ –¥–æ—Ö–æ–¥–æ–º —è–∫ —Å—Ç–æ–≤–ø—á–∏–∫–æ–≤—É –¥—ñ–∞–≥—Ä–∞–º—É" class="form-input" id="questionInput" required>
          </div>
          <button type="submit" class="btn btn-primary" id="analyzeBtn">
            –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ
          </button>
        </form>
        
        <div class="demo-example">
          –°–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø–∏—Ç: <code>–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –ø–æ–º—ñ—Å—è—á–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ –∑–∞ —Ä–µ–≥—ñ–æ–Ω–∞–º–∏ —É 2024</code> –∞–±–æ <code>–ü–æ–∫–∞–∑–∞—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∑–∞ –¥–æ—Ö–æ–¥–æ–º (–∫—Ä—É–≥–æ–≤–∞ –¥—ñ–∞–≥—Ä–∞–º–∞)</code>
        </div>
        
        <div id="errorMessage" class="error-message" style="display: none;"></div>
        <div id="successMessage" class="success-message" style="display: none;"></div>
        
        <div class="results" id="resultsContainer">
          <!-- –õ–Ü–í–ê –ü–ê–ù–ï–õ–¨ -->
          <div class="result-panel">
            <div class="result-title">–ü—ñ–¥—Å—É–º–æ–∫</div>

            <div class="kpi-grid" id="kpiGrid"></div>
            <div class="mini-sep"></div>

            <div class="mini-meta">
              <div><span class="mini-label">–ó–∞–ø–∏—Ç–∞–Ω–Ω—è:</span> <span id="sumQuestion">‚Äî</span></div>
              <div><span class="mini-label">–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö:</span> <span id="sumDataset">‚Äî</span></div>
            </div>

            <div class="mini-sep"></div>

            <div class="highlights">
              <div class="hl-title">–û—Å–Ω–æ–≤–Ω–µ</div>
              <ul id="hlList" class="hl-list"></ul>
            </div>

            <details style="margin-top:16px;">
              <summary style="cursor:pointer; color: var(--accent);">–¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–æ–¥—Ä–æ–±–∏—Ü—ñ</summary>
              <div class="result-title" style="margin-top: 12px; font-size: 14px;">–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–æ–¥:</div>
              <div class="code-block" id="generatedCode"></div>
              <div class="result-title" style="font-size: 14px;">–ê–Ω–∞–ª—ñ–∑:</div>
              <div class="code-block" id="explanation"></div>
            </details>
          </div>

          <!-- –ü–†–ê–í–ê –ü–ê–ù–ï–õ–¨ -->
          <div class="result-panel">
            <div class="result-title">–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è</div>
            <div class="chart-container">
              <div class="chart-wrap">
                <canvas id="chartCanvas"></canvas>
                <img id="chartImage" class="chart-image" alt="–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫" style="display:none;">
                <div id="chartPlaceholder" style="color: var(--muted); display: none;">–ì—Ä–∞—Ñ—ñ–∫ –∑‚Äô—è–≤–∏—Ç—å—Å—è —Ç—É—Ç</div>
              </div>
            </div>

            <div class="vis-toolbar">
              <button class="btn btn-secondary btn-sm" id="btnDownload">–ó–±–µ—Ä–µ–≥—Ç–∏ PNG</button>
            </div>
            <div class="usage-indicator" id="usageStatus"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- –ë–ª–æ–∫ —ñ–∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏ -->
  <section id="features" class="features">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">–ü–æ—Ç—É–∂–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –Ω–∞ –®–Ü</h2>
        <p class="section-subtitle">
          –ü–µ—Ä–µ—Ç–≤–æ—Ä—é–π—Ç–µ —Å–∫–ª–∞–¥–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö –Ω–∞ –ø—Ä–æ—Å—Ç—É —Ä–æ–∑–º–æ–≤—É. –ë–µ–∑ SQL —ñ —Å–∫–ª–∞–¥–Ω–∏—Ö —Ñ–æ—Ä–º—É–ª ‚Äî –ª–∏—à–µ –ø—Ä–∏—Ä–æ–¥–Ω–∞ –º–æ–≤–∞.
        </p>
      </div>
      
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">üß†</div>
          <h3 class="feature-title">–û–±—Ä–æ–±–∫–∞ –ø—Ä–∏—Ä–æ–¥–Ω–æ—ó –º–æ–≤–∏</h3>
          <p class="feature-description">
            –°—Ç–∞–≤—Ç–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—é –º–æ–≤–æ—é. –ù–∞—à –®–Ü —Ä–æ–∑—É–º—ñ—î –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∑–≤‚Äô—è–∑–∫–∏ —Ç–∞ –Ω–∞–º—ñ—Ä–∏, —â–æ–± –Ω–∞–¥–∞—Ç–∏ —Ç–æ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon">üìä</div>
          <h3 class="feature-title">–ú–∏—Ç—Ç—î–≤—ñ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó</h3>
          <p class="feature-description">
            –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä—É–π—Ç–µ –∫—Ä–∞—Å–∏–≤—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ —Ç–∞ –¥—ñ–∞–≥—Ä–∞–º–∏: —Å—Ç–æ–≤–ø—á–∏–∫–æ–≤—ñ, –ª—ñ–Ω—ñ–π–Ω—ñ, –∫—Ä—É–≥–æ–≤—ñ, –≥—ñ—Å—Ç–æ–≥—Ä–∞–º–∏ ‚Äî –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω—ñ –ø—ñ–¥ –≤–∞—à—ñ –¥–∞–Ω—ñ.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon">üîí</div>
          <h3 class="feature-title">–ë–µ–∑–ø–µ—á–Ω–æ —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ</h3>
          <p class="feature-description">
            –í–∞—à—ñ –¥–∞–Ω—ñ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –±–µ–∑ –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è. –ù–µ–∑–∞–±–∞—Ä–æ–º ‚Äî –ª–æ–∫–∞–ª—å–Ω–∏–π —Ä–µ–∂–∏–º –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon">‚ö°</div>
          <h3 class="feature-title">–ë–ª–∏—Å–∫–∞–≤–∏—á–Ω–æ —à–≤–∏–¥–∫–æ</h3>
          <p class="feature-description">
            –û—Ç—Ä–∏–º—É–π—Ç–µ —ñ–Ω—Å–∞–π—Ç–∏ –∑–∞ —Å–µ–∫—É–Ω–¥–∏, –∞ –Ω–µ –≥–æ–¥–∏–Ω–∏. –ù–∞—à –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π —Ä—É—à—ñ–π –º–∏—Ç—Ç—î–≤–æ –æ–±—Ä–æ–±–ª—è—î –¥–∞–Ω—ñ —Ç–∞ —Ñ–æ—Ä–º—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon">üéØ</div>
          <h3 class="feature-title">–†–æ–∑—É–º–Ω—ñ —ñ–Ω—Å–∞–π—Ç–∏</h3>
          <p class="feature-description">
            –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏—è–≤–ª—è–π—Ç–µ –ø–∞—Ç–µ—Ä–Ω–∏, —Ç—Ä–µ–Ω–¥–∏ —Ç–∞ –∞–Ω–æ–º–∞–ª—ñ—ó. –û—Ç—Ä–∏–º—É–π—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ –¥–ª—è –∫—Ä–∞—â–∏—Ö —Ä—ñ—à–µ–Ω—å.
          </p>
        </div>
        
        <div class="feature-card">
          <div class="feature-icon">üì§</div>
          <h3 class="feature-title">–ï–∫—Å–ø–æ—Ä—Ç—É–π—Ç–µ –≤—Å–µ</h3>
          <p class="feature-description">
            –ó–∞–≤–∞–Ω—Ç–∞–∂—É–π—Ç–µ –≥—Ä–∞—Ñ—ñ–∫–∏ —è–∫ PNG, –µ–∫—Å–ø–æ—Ä—Ç—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —è–∫ CSV –∞–±–æ –≥–µ–Ω–µ—Ä—É–π—Ç–µ PDF-–∑–≤—ñ—Ç–∏. –Ü–Ω—Å–∞–π—Ç–∏ ‚Äî —É –∑—Ä—É—á–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- –°–µ–∫—Ü—ñ—è —Å–ø–∏—Å–∫—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è -->
  <section id="waitlist">
    <div class="container">
      <div class="waitlist">
        <h3>–û—Ç—Ä–∏–º–∞–π—Ç–µ —Ä–∞–Ω–Ω—ñ–π –¥–æ—Å—Ç—É–ø</h3>
        <p>–ë—É–¥—å—Ç–µ —Å–µ—Ä–µ–¥ –ø–µ—Ä—à–∏—Ö, —Ö—Ç–æ —Å–ø—Ä–æ–±—É—î –º–∞–π–±—É—Ç–Ω—î –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ –¥–∞–Ω–∏—Ö. –î–æ–ª—É—á–∞–π—Ç–µ—Å—è –¥–æ —Å–ø–∏—Å–∫—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –π –æ—Ç—Ä–∏–º—É–π—Ç–µ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø.</p>
        
        <form class="waitlist-form" id="waitlistForm">
          <div class="form-group">
            <input type="text" placeholder="–Ü–º‚Äô—è" class="form-input" id="firstNameInput" required>
          </div>
          <div class="form-group">
            <input type="text" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ" class="form-input" id="lastNameInput" required>
          </div>
          <div class="form-group form-row-full">
            <input type="email" placeholder="–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞" class="form-input" id="emailInput" required>
          </div>
          <div class="form-group form-row-full">
            <input type="text" placeholder="–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ)" class="form-input" id="companyInput" >
          </div>
          <div class="form-row-full submit-row">
            <button type="submit" class="btn btn-primary submit-btn" id="joinBtn">–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É</button>
          </div>
          
          <!-- –ü–∞—Å—Ç–∫–∞ –¥–ª—è –±–æ—Ç—ñ–≤ -->
          <input type="text" name="_hp" class="sr-only" tabindex="-1" autocomplete="off">
        </form>
        
        <div id="waitlistSuccess" class="success-message" style="display: none; margin-top: 16px;">
          ‚úÖ –í–∏ —É —Å–ø–∏—Å–∫—É! –ú–∏ –ø–æ–≤—ñ–¥–æ–º–∏–º–æ, –∫–æ–ª–∏ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è —Ä–∞–Ω–Ω—ñ–π –¥–æ—Å—Ç—É–ø.
        </div>
        <div id="waitlistError" class="error-message" style="display: none; margin-top: 16px;"></div>
        
        <p style="font-size: 14px; color: var(--muted); margin-top: 24px;">
          –õ–∏—à–µ –≤–∞–∂–ª–∏–≤—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ –±–µ—Ç–∞-–≤–µ—Ä—Å—ñ—é. –ú–æ–∂–Ω–∞ –≤—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –±—É–¥—å-–∫–æ–ª–∏.
        </p>
      </div>
    </div>
  </section>

  <!-- –§—É—Ç–µ—Ä -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 Diven </p>
    </div>
  </footer>

<script>
const FORMSPREE_ENDPOINT = "https://formspree.io/f/mqadkgnp";
const API_BASE = localStorage.getItem('DATAMIND_API') || ' https://stickers-up-hydrocodone-runs.trycloudflare.com';
const USAGE_KEY = "DATAMIND_DEMO_USED";

let currentChart = null;
let currentData = null;

// –†–µ—î—Å—Ç—Ä—É—î–º–æ –ø–ª–∞–≥—ñ–Ω
if (typeof Chart !== 'undefined' && typeof ChartDataLabels !== 'undefined') {
  Chart.register(ChartDataLabels);
}

// –£—Ç–∏–ª—ñ—Ç–∏
function showError(element, message) {
  if (element) {
    element.textContent = message;
    element.style.display = 'block';
  }
}

function showSuccess(element, message) {
  if (element) {
    element.textContent = message;
    element.style.display = 'block';
  }
}
document.addEventListener("DOMContentLoaded", () => {
  const langLinks = document.querySelectorAll(".lang-switch");

  langLinks.forEach(link => {
    link.addEventListener("click", (e) => {
      e.preventDefault();

      const lang = link.dataset.lang; // "ua" –∏–ª–∏ "en"
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –≤ localStorage
      localStorage.setItem("langOverride", lang);

      // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
      if (lang === "ua") {
        window.location.href = "/index.html";
      } else {
        window.location.href = "/index_eng.html";
      }
    });
  });
});
function hideMessage(element) {
  if (element) element.style.display = 'none';
}

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≥—Ä–∞—Ñ—ñ–∫–∞
function renderChart(cfg) {
  const ctx = document.getElementById('chartCanvas').getContext('2d');
  const chartImg = document.getElementById('chartImage');
  chartImg.style.display = 'none';

 if (currentChart) {
    currentChart.destroy();
    currentChart = null;
  }

  const isPie = (cfg.type === 'pie' || cfg.type === 'doughnut');
  const isHeatmap = cfg.type === 'heatmap';
  const plugins = [ChartDataLabels];

  // –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ —Ç–µ–ø–ª–æ–≤—É –∫–∞—Ä—Ç—É
  if (isHeatmap) {
    currentChart = new Chart(ctx, {
      type: 'matrix',
      data: {
        datasets: [{
          label: cfg.title || '–¢–µ–ø–ª–æ–≤–∞ –∫–∞—Ä—Ç–∞',
          data: cfg.data, // [{x, y, v}]
          backgroundColor: ctx => {
            const value = ctx.dataset.data[ctx.dataIndex].v;
            const max = cfg.maxValue || 1;
            const alpha = Math.min(1, value / max);
            return `rgba(59, 130, 246, ${alpha})`;
          },
          width: ({chart}) => (chart.chartArea.width / cfg.xLabels.length) - 2,
          height: ({chart}) => (chart.chartArea.height / cfg.yLabels.length) - 2,
          borderWidth: 1,
          borderColor: '#222'
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              title: ctx => `–ú—ñ—Å—è—Ü—å: ${cfg.xLabels[ctx[0].dataIndex % cfg.xLabels.length]}`,
              label: ctx => `–î–æ—Ö—ñ–¥: ${ctx.dataset.data[ctx.dataIndex].v.toFixed(2)}`
            }
          }
        },
        scales: {
          x: {
            labels: cfg.xLabels,
            offset: true,
            grid: { display: false },
            ticks: { color: '#ccc', font: { size: 12 } }
          },
          y: {
            labels: cfg.yLabels,
            offset: true,
            grid: { display: false },
            ticks: { color: '#ccc', font: { size: 12 } }
          }
        }
      }
    });
    return;
  }

  // –Ü–Ω—à—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ (bar, pie, line)
  currentChart = new Chart(ctx, {
    type: cfg.type || 'bar',
    data: {
      labels: cfg.labels || [],
      datasets: (cfg.datasets || []).map(ds => ({
        ...ds,
        borderWidth: 1
      }))
    },
    options: {
      responsive: true,
      maintainAspectRatio: true,
      plugins: {
        legend: { position: 'top', labels: { boxWidth: 12 } },
        title: { display: !!cfg.title, text: cfg.title },
        datalabels: isPie ? {
          formatter: (v, ctx) => {
            const ds = ctx.chart.data.datasets[0];
            const sum = ds.data.reduce((a, b) => a + b, 0) || 1;
            const pct = Math.round((v / sum) * 100);
            return pct >= 5 ? pct + '%' : '';
          },
          anchor: 'center',
          align: 'center'
        } : { display: false }
      },
      scales: isPie ? {} : {
        x: { grid: { color: 'rgba(255,255,255,0.06)' } },
        y: { grid: { color: 'rgba(255,255,255,0.06)' }, ticks: { beginAtZero: true } }
      }
    },
    plugins
  });
}

function showChartFallback() {
  const canvas = document.getElementById('chartCanvas');
  const chartImage = document.getElementById('chartImage');
  const placeholder = document.getElementById('chartPlaceholder');

  if (canvas) canvas.style.display = 'none';
  
  if (currentData && currentData.chart_png_base64 && chartImage) {
    chartImage.src = `data:image/png;base64,${currentData.chart_png_base64}`;
    chartImage.style.display = 'block';
    if (placeholder) placeholder.style.display = 'none';
  } else if (placeholder) {
    placeholder.style.display = 'block';
    if (chartImage) chartImage.style.display = 'none';
  }
}

function setupChartButtons(config) {
  const downloadBtn = document.getElementById('btnDownload');
  const typeBtn = document.getElementById('btnType');

  if (downloadBtn) {
    downloadBtn.onclick = () => {
      if (currentChart) {
        const url = currentChart.toBase64Image('image/png', 1.0);
        const link = document.createElement('a');
        link.download = `${config.title || 'chart'}.png`;
        link.href = url;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      } else if (currentData && currentData.chart_png_base64) {
        const link = document.createElement('a');
        link.download = 'chart.png';
        link.href = `data:image/png;base64,${currentData.chart_png_base64}`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
    };
  }

  if (typeBtn) {
    typeBtn.onclick = () => {
      if (!currentChart) return;
      
      const currentType = currentChart.config.type;
      const newType = currentType === 'bar' ? 'pie' : 'bar';
      
      currentChart.config.type = newType;
      
      const isPie = newType === 'pie' || newType === 'doughnut';
      currentChart.options.plugins.datalabels.display = isPie;
      currentChart.options.scales = isPie ? {} : {
        x: {
          ticks: { color: '#94a3b8' },
          grid: { color: 'rgba(255, 255, 255, 0.1)' }
        },
        y: {
          ticks: { color: '#94a3b8', beginAtZero: true },
          grid: { color: 'rgba(255, 255, 255, 0.1)' }
        }
      };
      
      currentChart.update();
    };
  }
}

// –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
function displayResults(data) {
  currentData = data;
    let chartTitle = data.chart_js?.title || data.intent || '–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö';

  const sumQuestion = document.getElementById('sumQuestion');
  const sumDataset = document.getElementById('sumDataset');
  
  if (sumQuestion) sumQuestion.textContent = data.question || '–ù–µ –≤–∫–∞–∑–∞–Ω–æ';
  if (sumDataset) {
    const rows = data.summary?.dataset?.rows || data.rows || '?';
    const cols = data.summary?.dataset?.cols_count || data.cols?.length || '?';
    sumDataset.textContent = `${rows} —Ä—è–¥–∫—ñ–≤ ‚Ä¢ ${cols} —Å—Ç–æ–≤–ø—Ü—ñ–≤`;
  }
if (data.chart_js && data.chart_js.labels && data.chart_js.datasets) {
  renderChart({
    type: data.chart_js.type || 'bar',
    labels: data.chart_js.labels,
    datasets: data.chart_js.datasets,
    title: chartTitle
  });
  setupChartButtons({ title: chartTitle });   // <<< –í–ê–ñ–ù–û
} else if (data.chart_png_base64) {
  showChartFallback();
  setupChartButtons({ title: chartTitle });   // <<< –∏ —Ç—É—Ç —Ç–æ–∂–µ
}
  // KPI
  const kpiGrid = document.getElementById('kpiGrid');
  if (kpiGrid) {
    kpiGrid.innerHTML = '';
    const kpis = data.summary?.kpis || [];
    
    if (kpis.length > 0) {
      kpis.forEach(kpi => {
        const kpiEl = document.createElement('div');
        kpiEl.className = 'kpi-card';
        kpiEl.innerHTML = `
          <div class="kpi-label">${kpi.label || '–ü–æ–∫–∞–∑–Ω–∏–∫'}</div>
          <div class="kpi-value">${kpi.value || 'N/A'}</div>
          ${kpi.sub ? `<div class="kpi-sub">${kpi.sub}</div>` : ''}
        `;
        kpiGrid.appendChild(kpiEl);
      });
    } else {
      const kpiEl = document.createElement('div');
      kpiEl.className = 'kpi-card';
      kpiEl.innerHTML = `
        <div class="kpi-label">–°—Ç–∞—Ç—É—Å</div>
        <div class="kpi-value">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div>
        <div class="kpi-sub">–ê–Ω–∞–ª—ñ–∑ –≤–∏–∫–æ–Ω–∞–Ω–æ</div>
      `;
      kpiGrid.appendChild(kpiEl);
    }
  }

  // –û—Å–Ω–æ–≤–Ω—ñ –º–æ–º–µ–Ω—Ç–∏
  const hlList = document.getElementById('hlList');
  if (hlList) {
    hlList.innerHTML = '';
    const highlights = data.summary?.highlights || [];
    
    if (highlights.length > 0) {
      highlights.forEach(highlight => {
        const li = document.createElement('li');
        li.textContent = highlight;
        hlList.appendChild(li);
      });
    } else {
      const li = document.createElement('li');
      li.textContent = '–ê–Ω–∞–ª—ñ–∑ —É—Å–ø—ñ—à–Ω–æ –≤–∏–∫–æ–Ω–∞–Ω–æ';
      hlList.appendChild(li);
    }
  }

  // –ö–æ–¥ —ñ –ø–æ—è—Å–Ω–µ–Ω–Ω—è
  const generatedCode = document.getElementById('generatedCode');
  const explanation = document.getElementById('explanation');
  
  if (generatedCode) {
    generatedCode.textContent = data.pandas_code || '# –ö–æ–¥ –Ω–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ';
  }
  
  if (explanation) {
    const explanationText = [
      data.intent ? `–ù–∞–º—ñ—Ä: ${data.intent}` : '',
      data.reasoning ? `–ú—ñ—Ä–∫—É–≤–∞–Ω–Ω—è: ${data.reasoning}` : '',
      data.answer_hint ? `–Ü–Ω—Å–∞–π—Ç–∏: ${data.answer_hint}` : ''
    ].filter(Boolean).join('\n\n') || '–ê–Ω–∞–ª—ñ–∑ –≤–∏–∫–æ–Ω–∞–Ω–æ';
    
    explanation.textContent = explanationText;
  }

  // –†–µ–Ω–¥–µ—Ä–∏–º–æ –≥—Ä–∞—Ñ—ñ–∫
  if (data.chart_js && data.chart_js.labels && data.chart_js.datasets) {
    renderChart({
      type: data.chart_js.type || 'bar',
      labels: data.chart_js.labels,
      datasets: data.chart_js.datasets,
      title: data.chart_js.title || data.intent || '–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö'
    });
  } else if (data.chart_png_base64) {
    showChartFallback();
  }

  // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
  const resultsContainer = document.getElementById('resultsContainer');
  if (resultsContainer) {
    resultsContainer.style.display = 'grid';
  }
}
const fileInput = document.getElementById('dataFile');
const fileLabel = document.getElementById('fileLabel');
const fileBrowseBtn = document.getElementById('fileBrowseBtn');

function truncateFileName(name, maxLength = 25) {
  if (name.length <= maxLength) return name;
  const ext = name.split('.').pop();
  const base = name.substring(0, maxLength - ext.length - 3);
  return `${base}...${ext}`;
}

if (fileInput) {
  fileInput.addEventListener('change', () => {
    const file = fileInput.files[0];

    if (file) {
      // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
      fileBrowseBtn.textContent = '–§–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ';
      fileBrowseBtn.classList.add('loaded');

      // –û–±–Ω–æ–≤–ª—è–µ–º –ª–µ–π–±–ª –Ω–∞ –∏–º—è —Ñ–∞–π–ª–∞
      fileLabel.textContent = truncateFileName(file.name);
    } else {
      // –ï—Å–ª–∏ —Ñ–∞–π–ª —É–±—Ä–∞–ª–∏ ‚Äî –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
      fileBrowseBtn.textContent = '–û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª';
      fileBrowseBtn.classList.remove('loaded');
      fileLabel.textContent = '–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª';
    }
  });
}
// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ª—ñ–º—ñ—Ç—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
function checkUsageLimit() {
  if (localStorage.getItem(USAGE_KEY) === "1") {
    const analyzeBtn = document.getElementById('analyzeBtn');
    const usageStatus = document.getElementById('usageStatus');
    
    if (analyzeBtn) {
      analyzeBtn.disabled = true;
      analyzeBtn.textContent = "–î–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ";
    }
    
    if (usageStatus) {
      usageStatus.textContent = "–õ—ñ–º—ñ—Ç –¥–µ–º–æ –¥–æ—Å—è–≥–Ω—É—Ç–æ (1/1). –°–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ—é ¬´–°–∫–∏–Ω—É—Ç–∏ –¥–µ–º–æ¬ª.";
    }
    
    return true;
  }
  return false;
}

// –í–∏–∫–ª–∏–∫ API
async function callAnalyzeAPI(file, question) {
  const formData = new FormData();
  formData.append('file', file);
  formData.append('question', question);

  const response = await fetch(`${API_BASE}/analyze`, {
    method: 'POST',
    body: formData
  });

  if (!response.ok) {
    const errorText = await response.text().catch(() => '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞');
    throw new Error(`–ü–æ–º–∏–ª–∫–∞ API (${response.status}): ${errorText}`);
  }

  const data = await response.json();

  if (data.ok === false) {
    throw new Error(data.error || '–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑');
  }

  return data;
}

// –ê–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö
async function analyzeData(file, question) {
  const analyzeBtn = document.getElementById('analyzeBtn');
  const errorMsg = document.getElementById('errorMessage');
  const successMsg = document.getElementById('successMessage');

  hideMessage(errorMsg);
  hideMessage(successMsg);

  if (!file) {
    showError(errorMsg, '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª');
    return;
  }

  if (!question.trim()) {
    showError(errorMsg, '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∑–∞–ø–∏—Ç–∞–Ω–Ω—è');
    return;
  }

  if (analyzeBtn) {
    analyzeBtn.disabled = true;
    analyzeBtn.textContent = '–ê–Ω–∞–ª—ñ–∑—É—é...';
  }

  try {
    const data = await callAnalyzeAPI(file, question.trim());
    localizeResponse(data);
    displayResults(data);
    showSuccess(successMsg, '–ê–Ω–∞–ª—ñ–∑ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
    
    localStorage.setItem(USAGE_KEY, "1");
    const usageStatus = document.getElementById('usageStatus');
    if (usageStatus) {
      usageStatus.textContent = "–î–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ (1/1). –©–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å ¬´–°–∫–∏–Ω—É—Ç–∏ –¥–µ–º–æ¬ª.";
    }

  } catch (error) {
    showError(errorMsg, error.message || '–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
    
    if (analyzeBtn) {
      analyzeBtn.disabled = false;
      analyzeBtn.textContent = '–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ';
    }
  }
}
// ===== I18N LITE =====
const LOCALE = 'uk'; // 'uk' | 'ru' | 'en'
const DICT = {
  uk: {
    // KPI labels
    'Top': '–¢–æ–ø',
    'Low': '–ù–∞–π–Ω–∏–∂—á–∏–π',
    'Average': '–°–µ—Ä–µ–¥–Ω—î',
    'Total': '–°—É–º–∞',
    // Highlights prefixes
    '^Dominant:': '–õ—ñ–¥–µ—Ä:',
    '^Weakest:': '–ù–∞–π—Å–ª–∞–±—à–∏–π:',
    // generic
    'Metric': '–ü–æ–∫–∞–∑–Ω–∏–∫',
    'Status': '–°—Ç–∞—Ç—É—Å',
    'Complete': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
    'Analysis finished': '–ê–Ω–∞–ª—ñ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–æ'
  },
  ru: {
    'Top': '–¢–æ–ø',
    'Low': '–ú–∏–Ω–∏–º—É–º',
    'Average': '–°—Ä–µ–¥–Ω–µ–µ',
    'Total': '–°—É–º–º–∞',
    '^Dominant:': '–õ–∏–¥–µ—Ä:',
    '^Weakest:': '–°–ª–∞–±–µ–π—à–∏–π:',
    'Metric': '–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å',
    'Status': '–°—Ç–∞—Ç—É—Å',
    'Complete': '–ì–æ—Ç–æ–≤–æ',
    'Analysis finished': '–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à—ë–Ω'
  }
};

const nf = new Intl.NumberFormat(LOCALE, { maximumFractionDigits: 2 });

function tWord(s) {
  const dict = DICT[LOCALE] || {};
  if (!s) return s;
  // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ –∑–∞–º–µ–Ω—ã (regex-–∫–ª—é—á–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å ^)
  for (const [k, v] of Object.entries(dict)) {
    if (k.startsWith('^')) {
      const re = new RegExp(k, 'i');
      if (re.test(s)) return s.replace(re, v);
    }
  }
  // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
  return dict[s] || s;
}

// –ü–µ—Ä–µ–≤–æ–¥ KPI –∏ —Ö–∞–π–ª–∞–π—Ç–æ–≤ –≤ –æ–±—ä–µ–∫—Ç–µ –æ—Ç–≤–µ—Ç–∞
function localizeResponse(data) {
  // KPI
  const kpis = data?.summary?.kpis;
  if (Array.isArray(kpis)) {
    kpis.forEach(k => {
      if (k.label) k.label = tWord(k.label);
      // –ü–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —á–∏—Å–ª–∞ –ª–æ–∫–∞–ª—å–Ω–æ (–µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ —Å —á–∏—Å–ª–æ–º)
      if (typeof k.value === 'string' && !isNaN(Number(k.value.replace(/[, ]/g,'')))) {
        const num = Number(k.value.replace(/[, ]/g,''));
        k.value = nf.format(num);
      }
      if (typeof k.sub === 'string') {
        // –ü—Ä–æ–±—É–µ–º –≤—ã—Ç–∞—â–∏—Ç—å —á–∏—Å–ª–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "col: 12,345.67"
        const m = k.sub.match(/^(.*?:)\s*([0-9.,\s]+)$/);
        if (m) k.sub = `${m[1]} ${nf.format(Number(m[2].replace(/[, ]/g,'')))}`
      }
    });
  }

  // Highlights
  const hl = data?.summary?.highlights;
  if (Array.isArray(hl)) {
    data.summary.highlights = hl.map(line => tWord(line));
  }

  // –§–æ–ª–±—ç–∫ –¥–ª—è —Å–ª—É—á–∞–µ–≤ –±–µ–∑ summary
  if (!data.summary) data.summary = {};
  return data;
}
// –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Ñ–æ—Ä–º–∏ —Å–ø–∏—Å–∫—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è
async function submitWaitlist(formData) {
  const form = new FormData();
  Object.entries(formData).forEach(([key, value]) => {
    form.append(key, value);
  });
  form.append('timestamp', new Date().toISOString());
  form.append('source', 'datamind_landing');

  const response = await fetch(FORMSPREE_ENDPOINT, {
    method: 'POST',
    body: form,
    headers: { 'Accept': 'application/json' }
  });

  if (!response.ok) {
    const errorData = await response.json().catch(() => ({}));
    throw new Error(errorData.error || `–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ (${response.status})`);
  }

  return response.json();
}

// –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
document.addEventListener('DOMContentLoaded', function() {
  // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ª—ñ–º—ñ—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
  checkUsageLimit();

  // –§–æ—Ä–º–∞ –¥–µ–º–æ
  const demoForm = document.getElementById('demoForm');
  if (demoForm) {
    demoForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      if (checkUsageLimit()) {
        showError(document.getElementById('errorMessage'), '–õ—ñ–º—ñ—Ç –¥–µ–º–æ –¥–æ—Å—è–≥–Ω—É—Ç–æ. –°–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ—é ¬´–°–∫–∏–Ω—É—Ç–∏ –¥–µ–º–æ¬ª.');
        return;
      }

      const fileInput = document.getElementById('dataFile');
      const questionInput = document.getElementById('questionInput');
      
      const file = fileInput?.files[0];
      const question = questionInput?.value || '';

      await analyzeData(file, question);
    });
  }
const fileInput = document.getElementById('dataFile');
  const fileDrop = document.getElementById('fileDrop');
  const fileBrowseBtn = document.getElementById('fileBrowseBtn');
  const fileNameEl = document.getElementById('fileName');

  function setFileName(f) {
    if (!fileNameEl) return;
    fileNameEl.textContent = f ? `${f.name} ‚Ä¢ ${(f.size/1024/1024).toFixed(2)} MB` : '–§–∞–π–ª –Ω–µ –æ–±—Ä–∞–Ω–æ';
  }

  if (fileBrowseBtn && fileInput) {
    fileBrowseBtn.addEventListener('click', () => fileInput.click());
  }

  if (fileInput) {
    fileInput.addEventListener('change', () => {
      const f = fileInput.files && fileInput.files[0];
      setFileName(f);
    });
  }

  if (fileDrop) {
    // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
    ['dragenter', 'dragover'].forEach(evt =>
      fileDrop.addEventListener(evt, (e) => {
        e.preventDefault(); e.stopPropagation();
        fileDrop.classList.add('dragover');
      })
    );
    ['dragleave', 'drop'].forEach(evt =>
      fileDrop.addEventListener(evt, (e) => {
        e.preventDefault(); e.stopPropagation();
        fileDrop.classList.remove('dragover');
      })
    );
    fileDrop.addEventListener('drop', (e) => {
      const files = e.dataTransfer?.files;
      if (files && files.length) {
        fileInput.files = files; // –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –≤ —Ä–µ–∞–ª—å–Ω—ã–π input
        setFileName(files[0]);
      }
    });
  }
  // –§–æ—Ä–º–∞ —Å–ø–∏—Å–∫—É –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è
  const waitlistForm = document.getElementById('waitlistForm');
  if (waitlistForm) {
    waitlistForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const firstName = document.getElementById('firstNameInput')?.value?.trim();
      const lastName = document.getElementById('lastNameInput')?.value?.trim();
      const email = document.getElementById('emailInput')?.value?.trim();
      const company = document.getElementById('companyInput')?.value?.trim();
      
      const joinBtn = document.getElementById('joinBtn');
      const successMsg = document.getElementById('waitlistSuccess');
      const errorMsg = document.getElementById('waitlistError');

      hideMessage(successMsg);
      hideMessage(errorMsg);

      if (!firstName) {
        showError(errorMsg, '–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ —ñ–º‚Äô—è');
        return;
      }
      if (!lastName) {
        showError(errorMsg, '–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –ø—Ä—ñ–∑–≤–∏—â–µ');
        return;
      }
      if (!email || !email.includes('@')) {
        showError(errorMsg, '–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –¥—ñ–π—Å–Ω—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É');
        return;
      }
      if (!company) {
        showError(errorMsg, '–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞–∑–≤—É –∫–æ–º–ø–∞–Ω—ñ—ó');
        return;
      }

      if (joinBtn) {
        joinBtn.disabled = true;
        joinBtn.textContent = '–ü—Ä–∏—î–¥–Ω—É—î–º–æ...';
      }

      try {
        await submitWaitlist({ firstName, lastName, email, company });
        
        showSuccess(successMsg, '‚úÖ –í–∏ —É —Å–ø–∏—Å–∫—É! –ú–∏ –ø–æ–≤—ñ–¥–æ–º–∏–º–æ, –∫–æ–ª–∏ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è —Ä–∞–Ω–Ω—ñ–π –¥–æ—Å—Ç—É–ø.');
        waitlistForm.reset();
        
        if (joinBtn) joinBtn.textContent = '–ü—Ä–∏—î–¥–Ω–∞–Ω–æ!';

        if (typeof gtag === 'function') {
          gtag('event', 'signup', {
            event_category: 'waitlist',
            event_label: 'datamind'
          });
        }

      } catch (error) {
        showError(errorMsg, error.message || '–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
        
        if (joinBtn) {
          joinBtn.disabled = false;
          joinBtn.textContent = '–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É';
        }
      }
    });
  }

  // –ü–ª–∞–≤–Ω–µ –ø—Ä–æ–∫—Ä—É—á—É–≤–∞–Ω–Ω—è
  document.querySelectorAll('a[href^="#"]').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const target = document.querySelector(link.getAttribute('href'));
      if (target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });
});
</script>
</body>
</html>